{% include 'nav.html' %}
<div id="pop" class="alert" style="display: none">
    <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
    Success, it is saved
</div>
<div style="margin-top: -0%" class="header hcenter">
    <h1 id="brand" class="page-header">
        Does this belongs in :
    </h1>

    <div id="btn">
        <div class="dropup" style="display: inline">
            <button class="btn btn-primary dropdown-toggle" id="report" type="button" data-toggle="dropdown">Report
                <span class="caret"></span></button>
            <ul class="dropdown-menu">
                <li><a id="nd">No display</a></li>
                <li><a id="ii">Inappropriate image</a></li>
                <li><a id="hmc">Huge miss-classification</a></li>
            </ul>
        </div>
        <button id="skip" class="btn">skip
        </button>


    </div>
</div>

<div id="tinderslide" class="centerswi">


    <ul class="ula">
        <li class="pane1 lia"
            style="     -moz-box-shadow: 5px 5px 5px 0px #656565;
    -webkit-box-shadow: 5px 5px 5px 0px #656565;
    -o-box-shadow: 5px 5px 5px 0px #656565;
    box-shadow: 5px 5px 5px 0px #656565;
    filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;background-position:center;background-repeat: no-repeat;background-size:contain;position: absolute;z-index: 20">
            <div class="img"></div>
            <div id="1_txt" style="display: none"></div>
            <div class="like" style="opacity: 0"><i class="fa fa-thumbs-up fa-5x green-text"
                                                    aria-hidden="true"></i></div>
            <div class="dislike" style="opacity: 0"><i class="fa fa-thumbs-down fa-5x red-text"
                                                       aria-hidden="true"></i></div>
        </li>
        <li class="pane2 lia"
            style="     -moz-box-shadow: 5px 5px 5px 0px #656565;
    -webkit-box-shadow: 5px 5px 5px 0px #656565;
    -o-box-shadow: 5px 5px 5px 0px #656565;
    box-shadow: 5px 5px 5px 0px #656565;
    filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;background-position:center;background-repeat: no-repeat;background-size:contain;position: absolute;z-index: 25">
            <div class="img"></div>
            <div id="2_txt" style="display: none"></div>
            <div class="like" style="opacity: 0"><i class="fa fa-thumbs-up fa-5x green-text"
                                                    aria-hidden="true"></i></div>
            <div class="dislike" style="opacity: 0"><i class="fa fa-thumbs-down fa-5x red-text"
                                                       aria-hidden="true"></i></div>
        </li>
        <li class="pane3 lia"
            style="     -moz-box-shadow: 5px 5px 5px 0px #656565;
    -webkit-box-shadow: 5px 5px 5px 0px #656565;
    -o-box-shadow: 5px 5px 5px 0px #656565;
    box-shadow: 5px 5px 5px 0px #656565;
    filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;background-position:center;background-repeat: no-repeat;background-size:contain;position: absolute;z-index: 30">
            <div class="img"></div>
            <div id="3_txt" style="display: none"></div>
            <div class="like" style="opacity: 0"><i class="fa fa-thumbs-up fa-5x green-text"
                                                    aria-hidden="true"></i></div>
            <div class="dislike" style="opacity: 0"><i class="fa fa-thumbs-down fa-5x red-text"
                                                       aria-hidden="true"></i></div>
        </li>
        <li class="pane4 lia"
            style="-moz-box-shadow: 5px 5px 5px 0px #656565;-webkit-box-shadow: 5px 5px 5px 0px #656565;-o-box-shadow: 5px 5px 5px 0px #656565;box-shadow: 5px 5px 5px 0px #656565;filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);-moz-border-radius: 5px;webkit-border-radius: 5px;border-radius: 5px; background-position:center;background-repeat: no-repeat;background-size:contain;position: absolute;z-index: 35">
            <div class="img"></div>
            <div id="4_txt" style="display: none"></div>
            <div class="like" style="opacity: 0"><i class="fa fa-thumbs-up fa-5x green-text"
                                                    aria-hidden="true"></i></div>
            <div class="dislike" style="opacity: 0"><i class="fa fa-thumbs-down fa-5x red-text"
                                                       aria-hidden="true"></i></div>
        </li>
        <li class="pane5 lia" id="test5"
            style="     -moz-box-shadow: 5px 5px 5px 0px #656565;
                                        -webkit-box-shadow: 5px 5px 5px 0px #656565;
                                        -o-box-shadow: 5px 5px 5px 0px #656565;
                                        box-shadow: 5px 5px 5px 0px #656565;
                                        filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
                                        -moz-border-radius: 5px;
                                        -webkit-border-radius: 5px;
                                        border-radius: 5px;
                                        background-position: center;
                                        background-repeat: no-repeat;
                                        background-size: contain;
                                        position: absolute;
                                        z-index: 40;
                            ">
            <div class="img"></div>
            <div id="5_txt" style="display: none"></div>
            <div class="like" style="opacity: 0"><i class="fa fa-thumbs-up fa-5x green-text"
                                                    aria-hidden="true"></i></div>
            <div class="dislike" style="opacity: 0"><i class="fa fa-thumbs-down fa-5x red-text"
                                                       aria-hidden="true"></i></div>
        </li>
    </ul>

</div>

<script src="{{ url_for('static', filename='assets/js/jquery-1.10.2.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery.transform2d.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/report.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery.jTinder.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>


<script type="text/javascript">
    var cat = ["reaching ..."];
    var nb = 5;
    var info = [];
    var width = screen.width;
    var height = screen.height;
    var note = 0;


    function getit() {
        var res = [];
        res.push(info[nb - 1].idimage)
        return res
    }

    $(document).ready(function () {

        if (window.location.href.indexOf('quizz') !== -1) {
            var path = ["https://s3.eu-central-1.amazonaws.com/namethatchart-imagedataset/downloadApi/vis16cat/BubbleChart_147.jpg", "https://s3.eu-central-1.amazonaws.com/namethatchart-imagedataset/downloadApi/vis10cat/AreaGraph_16.gif", "https://s3.eu-central-1.amazonaws.com/namethatchart-imagedataset/downloadApi/vis10cat/ParetoChart_499.png", "https://s3.eu-central-1.amazonaws.com/namethatchart-imagedataset/downloadApi/vis10cat/RadarPlot_640.jpg", "https://s3.eu-central-1.amazonaws.com/namethatchart-imagedataset/downloadApi/vis10cat/VennDiagram_1024.gif"];
            cat = ["scatter plot", "Area chart", "Bar Chart", "Radar Chart", "Bubble Chart"];

            for (var i = 0; i < 5; i++) {
                var temp = $('.pane' + (i + 1));
                temp.css("width", "75%");
                temp.css("height", "55%");
                temp.css("max-width", "800px");
                temp.css("background-color", "#FFF");
                temp.css("border", "solid 1px");
                temp.css("background-image", 'url("' + path[i] + '")');
                $("#" + i + "_txt").text("");
                $("#brand").text("Does this belongs in \"" + cat[4] + "\" category");
            }

        } else {
            fill();


        }

    })
    ;

    $("#tinderslide").jTinder({

        onDislike: function (item) {
            console.log(item.index());

            if (window.location.href.indexOf('quizz') !== -1) {
                $("#brand").text("Does this belongs in \"" + cat[nb - 2] + " \" category");
                nb -= 1;
                if (item.index() == 0 || item.index() == 2 || item.index() == 4) {
                    note += 1
                }
                console.log(note);

                if (item.index() == 0) {

                    done(note);
                }
            } else {
                nb = nb - 1;
                var form = new FormData();
                form.append("vote", false);
                form.append("idimg", info[item.index()].idimage);
                form.append("idtype", info[item.index()].idtype);
                $("#brand").text("Does this belongs in \"" + cat[nb] + "\" category");
                $.ajax({
                    type: "POST",
                    url: "../saveswipe",
                    processData: false,
                    contentType: false,
                    data: form,
                    success: function () {
                        if (item.index() - 1 >= 0) {

                            var form = new FormData();
                            form.append("idimage", info[item.index() - 1].idimage);
                            form.append("idtype", info[item.index() - 1].idtype);
                            $.ajax({

                                type: "POST",
                                url: "../logswipes",
                                processData: false,
                                contentType: false,
                                data: form

                            });
                        }
                    }
                });
                if (item.index() == 0) {
                    if (window.location.href.indexOf('main') !== -1) {
                        window.location = "../main"
                    } else if (window.location.href.indexOf('raw') !== -1) {
                        window.location = "../raw"
                    }
                    else {
                        window.location = "swipes"
                    }
                }
            }
        },

        onLike: function (item) {
            if (window.location.href.indexOf('quizz') !== -1) {
                $("#brand").text("Does this belongs in \"" + cat[nb - 2] + "\" category");
                nb -= 1;
                if (item.index() == 1 || item.index() == 3) {
                    note += 1
                }

                if (item.index() == 0) {
                    done(note);
                }
            } else {
                nb = nb - 1;
                var form = new FormData();
                form.append("vote", true);
                form.append("idimage", info[item.index()].idimage);
                form.append("idtype", info[item.index()].idtype);
                $("#brand").text("Does this belongs in \"" + cat[nb] + "\" category");
                $.ajax({
                            type: "POST",
                            url: "../saveswipe",
                            processData: false,
                            contentType: false,
                            data: form,
                            success: function () {
                                if (item.index() - 1 >= 0) {

                                    var form = new FormData();
                                    form.append("idimg", info[item.index() - 1].idimage);
                                    form.append("idtype", info[item.index() - 1].idtype);
                                    $.ajax({

                                        type: "POST",
                                        url: "../logswipes",
                                        processData: false,
                                        contentType: false,
                                        data: form

                                    });
                                }
                            }
                        }
                );

                if (item.index() == 0) {
                    if (window.location.href.indexOf('main') !== -1) {
                        window.location = "../main"
                    } else if (window.location.href.indexOf('raw') !== -1) {
                        window.location = "../raw"
                    }
                    else {
                        window.location = "swipes"
                    }
                }
            }

        },
        animationRevertSpeed: 200,
        animationSpeed: 400,
        threshold: 1,
        likeSelector: '.like',
        dislikeSelector: '.dislike'
    })
    ;

    function done(val) {
        var form = new FormData();
        console.log(val);
        form.append("note", val);
        $.ajax({
            type: "POST",
            url: "../savenote",
            processData: false,
            contentType: false,
            data: form,
            success: function (data) {
                window.location = "../quizz"
            }
        })
    }

    function fill() {
        $.ajax({
            type: "GET",
            url: "../getfive",
            processData: false,
            contentType: false,
            success: function (data) {
                info = JSON.parse(data);
                var i = 1;
                info.forEach(function (img) {
                    cat.push(img.label);
                    var temp = $('.pane' + i);
                    temp.css("width", "75%");
                    temp.css("height", "55%");
                    temp.css("max-width", "800px");
                    temp.css("background-color", "#FFF");
                    temp.css("border", "solid 1px");
                    temp.css("background-image", 'url("' + img.path + '")');
                    temp.attr("value", img.idimage);
                    $("#" + i + "_txt").text(img.label);
                    $("#brand").text("Does this belongs in \"" + cat[nb] + "\" category");
                    i++;
                });

                var form = new FormData();
                form.append("idimg", info[4].idimage);
                form.append("idtype", info[4].idtype);
                $.ajax({

                    type: "POST",
                    url: "../logswipes",
                    processData: false,
                    contentType: false,
                    data: form

                });
            }
        });
    }

    $("#skip").click(function () {

        var firm = new FormData();
        firm.append("action", "skip");
        firm.append("ids", info[nb - 1].idimage);
        firm.append("idtype", info[nb - 1].idtype);
        $.ajax({
            type: "POST",
            url: "../logm/swipe",
            processData: false,
            contentType: false,
            data: firm
        });


        if (window.location.href.indexOf('hybrid') !== -1) {
            window.location = "../hybrid"
        } else {
            if (window.location.href.indexOf('main') !== -1) {
                window.location = "../main"
            } else if (window.location.href.indexOf('raw') !== -1) {
                window.location = "../raw"
            }
            else {
                fill()
            }
        }
    });

</script>
</body>


</html>