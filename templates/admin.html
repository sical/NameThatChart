<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Name That Chart</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/materialize/css/materialize.min.css') }}"
          media="screen,projection"/>
    <!-- Bootstrap Styles-->
    <link href="{{ url_for('static', filename='assets/css/bootstrap.css') }}" rel="stylesheet"/>
    <!-- FontAwesome Styles-->
    <link href="{{ url_for('static', filename='assets/css/font-awesome.css') }}" rel="stylesheet"/>
    <!-- Custom Styles-->
    <link href="{{ url_for('static', filename='assets/css/custom-styles.css') }}" rel="stylesheet"/>
    <!-- Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
</head>
<body>
<nav class="navbar navbar-default top-navbar" role="navigation">
    <div class="navbar-header">
        <a class="navbar-brand waves-effect waves-dark" href="/"><strong> <i
                class="large material-icons" id="icon">insert_chart</i>NameThatChart</strong></a>
        <ul class="nav navbar-top-links navbar-left" id="menu">
            <li>
                <div class="navbar-header" style="width: 30%">
                    <a class="navbar-brand waves-effect waves-dark" id="dire" href="textual">Textual</a>
                </div>
            </li>
            <li>
                <div class="navbar-header" style="width: 30%">
                    <a class="navbar-brand waves-effect waves-dark" id="dire" href="multiple">Multiple</a>
                </div>
            </li>
            <li>
                <div class="navbar-header" style="width: 30%">
                    <a class="navbar-brand waves-effect waves-dark" id="dire" href="admin">Admin</a>
                </div>
            </li>
        </ul>
    </div>
</nav>


<!-- /. NAV SIDE  -->
<div id="page-wrapper">
    <div class="header">
        <h1 class="page-header">
            Administration
            <small>Statistics</small>
        </h1>
    </div>
    <div id="page-inner">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-md-6">

                <div class="card horizontal cardIcon">
                    <div class="card-image blue waves-effect waves-dark" id="up">
                        <i class="fa fa-upload fa-5x "></i>
                    </div>
                    <div class="card-stacked">
                        <div class="card-content">
                            <h3>Upload </h3>
                        </div>
                        <div class="card-action">
                            <div class="switch">
                                <label>
                                    D3js
                                    <input type="checkbox">
                                    <span class="lever"></span>
                                    Image
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-xs-12 col-sm-6 col-md-6">

                <div class="card horizontal cardIcon ">
                    <div class="card-image blue waves-effect waves-dark" id="down">
                        <i class="fa fa-download fa-5x"></i>
                    </div>
                    <div class="card-stacked">
                        <div class="card-content">
                            <h3>Download</h3>
                        </div>
                        <div class="card-action">
                            <div class="switch">
                                <label>
                                    CSV
                                    <input type="checkbox" id="tp">
                                    <span class="lever"></span>
                                    JSON
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <div class="row">

            <div class="col-md-6">
                <div class="card">
                    <div class="card-action">
                        Textual stats
                    </div>
                    <div class="card-content">


                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-action">
                        Multiple stats
                    </div>
                    <div class="card-content">
                        Bar chart of Multiple results

                    </div>
                </div>
            </div>
        </div>

        <div class="row">

            <div class="col-md-6">
                <div class="card">
                    <div class="card-action">
                        Most active users
                    </div>
                    <div class="card-content">
                        table of users activities

                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-action">
                        Few numbers
                    </div>
                    <div class="card-content">
                        number of chart types, with or without url
                    </div>
                </div>
            </div>
        </div>
        <!-- /. PAGE INNER  -->
    </div>

    <!-- /. PAGE WRAPPER  -->
</div>
<!-- /. WRAPPER  -->
<!-- JS Scripts-->
<!-- jQuery Js -->
<script src="{{ url_for('static', filename='assets/js/jquery-1.10.2.js') }}"></script>

<!-- Bootstrap Js -->
<script src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>

<script src="{{ url_for('static', filename='assets/materialize/js/materialize.min.js') }}"></script>

<!-- Metis Menu Js -->
<script src="{{ url_for('static', filename='assets/js/jquery.metisMenu.js') }}"></script>

<script type="text/javascript">
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: "../firstrow",

            success: function (data) {
                data = JSON.parse(data);
                console.log(data);
                var i = 0;
                var numbers = ['first', 'second', 'third', 'fourth'];
                console.log(data[0]);
                for (i; i < 4; i++) {
                    console.log("#" + numbers[i] + "-text");
                    console.log(data[i][1]);
                    $("#" + numbers[i] + "-text").text(data[i][1]);
                    $("#" + numbers[i] + "-value").text(data[i][2]);
                }

            }
        });

    });

    $("#up").click(function () {

        window.location = "../upload"

    })

    $("#down").click(function () {
        var type = $("#tp").val();
        console.log(type);
        if( type=="on") {
            $.ajax({
                type: "GET",
                url: "../db2csv",
                success: function (data) {
                    var test_array = eval("[" + data + "]");
                    var csvContent = "data:text/csv;charset=utf-8,";
                    test_array.forEach(function (infoArray, index) {
                        infoArray.forEach(function (dato) {
                            dataString = dato.join();
                            csvContent += index < infoArray.length ? dataString + "\n" : dataString;
                        });
                    });
                    var encodedUri = encodeURI(csvContent);
                    saveAs(encodedUri, "data.csv")
                }

            })

        }else {

        }
    });

    function saveAs(uri, filename) {
        var link = document.createElement('a');
        if (typeof link.download === 'string') {
            document.body.appendChild(link); // Firefox requires the link to be in the body
            link.download = filename;
            link.href = uri;
            link.click();
            document.body.removeChild(link); // remove the link when done
        } else {
            location.replace(uri);
        }
    }

    $('#tp').change(function () {
        if ($(this).attr('checked')) {
            $(this).val('on');
        } else {
            $(this).val('off');
        }
    });

</script>

</div>


</body>

</html>