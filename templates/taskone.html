
{% include 'nav.html' %}

<!-- /. NAV SIDE  -->
<div id="page-wrapper">

    <div class="header">
        <h1 class="page-header" id="brand">
            Describe this chart with your own words
        </h1>

    </div>
    <div class="row">
        <div id="pop" class="alert" style="display: none">
            <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
            Success, it is saved
        </div>
    </div>
    <div id="page-inner">
        <div class="row">

            <div class="col-md-12">
                <div class="card">
                    <div class="card-content">
                        <img id="afi" height="600" width="600" src=""/>

                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-content" id="pres">
                        <div id="fom">
                            <input id="value" type="text" name="type" placeholder="What is this chart ?"
                                   maxlength="50"/>
                        </div>
                        <br/>
                        <button id="skip" class="waves-effect waves-light btn">skip
                        </button>
                        <button id="save" class="waves-effect waves-light btn">
                            save
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="clearBoth" style="text-align: center"><br/>

</div>


<!-- /. PAGE INNER  -->
</div>

<!-- /. PAGE WRAPPER  -->
</div>
<!-- /. WRAPPER  -->
<!-- JS Scripts-->
<!-- jQuery Js -->
<script src="{{ url_for('static', filename='assets/js/jquery-1.10.2.js') }}"></script>

<!-- Bootstrap Js -->
<script async src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>

<script async src="{{ url_for('static', filename='assets/materialize/js/materialize.min.js') }}"></script>


<script src="https://d3js.org/d3.v4.min.js"></script>

<script type="text/javascript">
    var started = true;

    $(document).ready(function () {
        var url;
        $.ajax({
            type: "GET",
            url: "../getnextpic",
            processData: false,
            contentType: false,
            success: function (data) {
                url = data;
                $("#afi").attr('src',"static/"+data)


            }
        });

        updateImageSize();
        $(window).resize(function () {
            updateImageSize();
        })

    })

</script>

<script async>
    $("#save").click(function () {
        var text = $("#value").val();
        $("#value").val('');
        $("#pop").show();
        var form = new FormData();

        var reg = /[\(,\)\'\~\`\"\{\}\+\=\#\&\][^²;:\\\/£$*¤µ¨%§!?.&\n\r><@]*/ig;
        text = text.replace(reg, "");
        form.append("name", text);


        $.ajax({
            type: "POST",
            url: "./savetext",
            enctype: 'mulipart/form-data',
            processData: false,
            contentType: false,
            data: form,
            success: function () {
                $.ajax({
                    type: "GET",
                    url: "../getnextpic",
                    processData: false,
                    contentType: false,
                    success: function (data) {

                        $("#dispres").empty();
                        $("#dispres").load("./textual/" + data);
                    }
                });
            }
        });

    });

    $("#skip").click(function () {
        firm = new FormData();
        firm.append("action", "skip");
        $.ajax({
            type: "POST",
            url: "../logaction",
            processData: false,
            contentType: false,
            data: firm
        });

        $.ajax({
            type: "GET",
            url: "../getnext",
            processData: false,
            contentType: false,
            success: function (data) {

                $("#dispres").empty();
                $("#dispres").load("./textual/" + data);
            }
        });
    });

    $("#value").on('input', function () {
        if ($("#value").val() != undefined) {
            if ($("#value").val().length == 1 && started) {
                started = false;
                firm = new FormData();
                firm.append("action", "started typing");
                $.ajax({
                    type: "POST",
                    url: "../logaction",
                    processData: false,
                    contentType: false,
                    data: firm
                });
            }
        }
    });


</script>

</body>

</html>